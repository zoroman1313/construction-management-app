# Authentication Flow - سیستم احراز هویت

## Overview - خلاصه

این سند توضیح می‌دهد که سیستم احراز هویت «ساده و بدون پلاگین» چگونه در اپلیکیشن مدیریت ساختمان کار می‌کند.

## User Flow - جریان کاربری

### 1. Initial State - حالت اولیه
- کاربر صفحه اصلی را با سه گزینه مشاهده می‌کند
- دکمه ورود در هدر نمایش داده می‌شود

### 2. انتخاب بخش
- 👥 کاربران (Users)
- 🏗️ پیمانکاران (Contractors)
- 🤝 ارایه‌دهندگان (Providers)

### 3. بررسی احراز هویت
- اگر کاربر وارد نشده باشد → به `pages/login.html` با پارامتر مقصد هدایت می‌شود (مثل `?destination=users`)
- اگر قبلاً وارد شده باشد → مستقیماً به صفحه مقصد هدایت می‌شود

### 4. بعد از ورود
- نام و آواتار کاربر در هدر نمایش داده می‌شود
- دکمه ورود با پروفایل کاربر جایگزین می‌شود
- دکمه خروج فعال می‌شود

## Technical Implementation - پیاده‌سازی فنی

- کلاس `SimpleAuth` در `js/auth.js`
- ذخیره کاربر در `localStorage` با کلید `currentUser`
- لیست کاربران در `localStorage` با کلید `users`
- API ساده در سطح سراسری: `window.simpleAuth`
  - `login(email, password)`
  - `register(name, email, phone, password, extra)`
  - `googleSignIn()` (شبیه‌سازی)
  - `isLoggedIn()` و `getCurrentUser()`
  - `logout()`

## Error Handling - مدیریت خطا

- پیام‌های فارسی برای خطاهای لاگین/ثبت‌نام
- تایید حداقل طول رمز عبور
- بررسی تکراری نبودن ایمیل در زمان ثبت‌نام
- اعلان‌های سبک (Toast) و خودکار حذف‌شونده

## Mobile - پاسخگویی موبایل

- فرم‌ها و دکمه‌ها برای لمس بهینه شده‌اند
- صفحات داخلی نیز از همان الگوی هدر/پروفایل پیروی می‌کنند

## Security Notes - نکات امنیتی

- این نسخه صرفاً نمونه بدون سرور است (دمو)
- برای نسخه تولیدی باید سمت‌سرور و هش رمز عبور اضافه شود

## Troubleshooting - عیب‌یابی

- ورود کار نمی‌کند: ایمیل/رمز را بررسی کنید یا کاربر جدید ثبت‌نام کنید
- پس از ورود هدایت نمی‌شود: `localStorage` را پاک کنید و دوباره تلاش کنید
- پروفایل نمایش داده نمی‌شود: کنسول مرورگر را برای خطاهای جاوااسکریپت بررسی کنید

---

آخرین به‌روزرسانی: 2025-08
